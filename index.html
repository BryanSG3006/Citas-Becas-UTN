<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Agendar Cita - Universidad TÃ©cnica Nacional</title>
    <link rel="stylesheet" href="./css/Style.css" />
    <link rel="stylesheet" href="./css/navbar.css" />
    <link rel="stylesheet" href="./css/footer.css" />
</head>

<body>

    <div id="navbar-container"></div>

    <div class="container">

        <!-- ENCABEZADO -->
        <header class="header">
            <div class="header-content">

                <!-- Logo en una "card" -->
                <div class="logo-card">
                    <img src="./img/logo.jpg" alt="logo" class="logo-img">
                </div>

                <!-- Texto a la derecha -->
                <div class="header-text">
                    <p class="subtitle">Sistema de Atencion de Trabajo Social </p>
                    <p>Agenda tu cita con trabajo social de manera rÃ¡pida y sencilla</p>
                </div>

            </div>
        </header>





        <!-- INFORMACIÃ“N RÃPIDA -->
        <div class="info-cards">
            <div class="info-card">
                <div class="info-icon">ðŸ•’</div>
                <h3>Horario de AtenciÃ³n</h3>
                <p>Lunes a Viernes<br>8:00 AM - 5:00 PM</p>
            </div>
            <div class="info-card">
                <div class="info-icon">âš¡</div>
                <h3>ConfirmaciÃ³n Inmediata</h3>
                <p>Recibe confirmaciÃ³n al instante por correo electrÃ³nico</p>
            </div>
            <div class="info-card">
                <div class="info-icon">ðŸ“±</div>
                <h3>Recordatorios</h3>
                <p>Te enviamos recordatorios antes de tu cita programada</p>
            </div>
        </div>

        <!-- SECCIÃ“N PRINCIPAL DE CALENDARIO -->
        <div class="calendar-container" id="calendario">
            <!-- Los calendarios se cargarÃ¡n aquÃ­ dinÃ¡micamente -->
        </div>


    </div>
    <div id="footer-container"></div>
</body>

<!-- Firebase SDKs -->

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDTV0RzmB-hv2CPbwM-gEbbkcMVsgSurAc",
        authDomain: "sistema-calendarios-utn.firebaseapp.com",
        projectId: "sistema-calendarios-utn",
        storageBucket: "sistema-calendarios-utn.appspot.com",
        messagingSenderId: "409729685216",
        appId: "1:409729685216:web:715075faa4dbe615342285",
        measurementId: "G-G8J5PLE64V"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const calendarioContainer = document.getElementById('calendario');

    async function cargarCalendariosDesdeFirestore() {
        const querySnapshot = await getDocs(collection(db, "calendarios"));
        if (!querySnapshot.empty) {
            // Oculta el calendario base si hay datos
            const calendarioBase = calendarioContainer.querySelector('.calendar-wrapper');
            if (calendarioBase) calendarioBase.style.display = 'none';
        }

        querySnapshot.forEach((doc) => {
            const data = doc.data();
            const url = data.url;

            const wrapper = document.createElement('div');
            wrapper.classList.add('calendar-wrapper');

            const iframe = document.createElement('iframe');
            iframe.src = url;
            iframe.loading = "lazy";
            iframe.title = "Calendario Agregado";

            wrapper.appendChild(iframe);
            calendarioContainer.appendChild(wrapper);
        });
    }

    window.addEventListener('DOMContentLoaded', cargarCalendariosDesdeFirestore);
</script>

<script>

    //Llamado al navbar
    fetch('./Layout/navbar.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('navbar-container').innerHTML = data;
        })
        .catch(error => {
            console.error('Error cargando el navbar:', error);
        });

    //Llamado al footer
    fetch('./Layout/footer.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('footer-container').innerHTML = data;
        })
        .catch(error => {
            console.error('Error cargando el footer:', error);
        });


</script>



</html>